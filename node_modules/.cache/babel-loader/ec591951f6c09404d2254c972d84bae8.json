{"ast":null,"code":"import { UPDATE_USER_DETAIL, UPDATE_USER_PROFILE, UPDATE_AUTH_ID, UPDATE_LOG_STATUS, UPDATE_LOG_INFO, UPDATE_USER_WALLET, USER_LOGOUT } from '../actionTypes';\nimport { sessionService } from 'redux-react-session';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { toggle_loader_on, toggle_loader_off } from '../actions';\nconst toastOpt = {\n  position: \"bottom-left\",\n  hideProgressBar: false,\n  closeOnClick: true,\n  draggable: true,\n  autoClose: 5000\n};\nconst BASE = \"https://hi-exchange.com\";\nexport const userLogout = _history => {\n  return dispatch => {\n    dispatch(toggle_loader_on());\n    sessionService.deleteUser().then(e => {\n      sessionService.deleteSession().then(e => {\n        _history.push(\"/otp-1\");\n      }).catch(err => {\n        console.log(err);\n      });\n    }).catch(err => {\n      console.log(err);\n    }).finally(e => {\n      setTimeout(() => {\n        dispatch(toggle_loader_off());\n      }, 2000);\n    });\n  };\n};\nexport const userUpdateDetail = (_history = undefined) => {\n  return dispatch => {\n    if (_history) dispatch(toggle_loader_on());\n    axios.get(BASE + \"/api/v2/account/details/\").then(data => {\n      sessionService.saveUser({ ...data.data\n      }).then(e => {\n        if (_history) _history.push({\n          pathname: \"/\"\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    }).catch(err => {\n      console.log(err);\n    }).finally(e => {\n      setTimeout(() => {\n        if (_history) dispatch(toggle_loader_off());\n      }, 800);\n    });\n  };\n};\nexport const userLogin = (credentias, _history, setIsSubmitting) => {\n  return dispatch => {\n    axios.post(BASE + \"/api/v2/token/verify/\", credentias).then(response => {\n      dispatch(toggle_loader_on());\n      const {\n        data\n      } = response;\n      const {\n        access: token,\n        refresh\n      } = data;\n      sessionService.saveSession({\n        token,\n        refresh,\n        refresh_time: new Date().getTime()\n      }).then(e => {\n        dispatch(userUpdateDetail(token, _history));\n      }).catch(err => {\n        console.log(err);\n      });\n    }).catch(err => {\n      toast.error(\"کد وارد شده صحیح نمی باشد.\", toastOpt);\n    }).finally(e => {\n      setIsSubmitting(false);\n      setTimeout(() => {\n        dispatch(toggle_loader_off());\n      }, 800);\n    });\n  };\n};\nexport const userSignup = (credentias, _history, setIsSubmitting) => {\n  return dispatch => {\n    axios.post(BASE + \"/api/v2/token/register/verify/\", credentias).then(response => {\n      if (response.data.error == 1) {\n        toast.error(response.data.message, toastOpt);\n      } else {\n        toast.success(response.data.message + \" در حال انتقال به صفحه ورود...\", { ...toastOpt,\n          onClose: () => {\n            _history.push(\"/signin\");\n          }\n        });\n\n        _history.push('/sigin');\n      }\n    }).catch(err => {\n      toast.error(\"کد وارد شده صحیح نمی باشد.\", toastOpt);\n    }).finally(e => {\n      setIsSubmitting(false);\n      setTimeout(() => {\n        dispatch(toggle_loader_off());\n      }, 800);\n    });\n  };\n};\nexport const userUpdateName = name => {\n  return dispatch => {\n    sessionService.loadSession().then(session => {\n      axios.post(\"https://hi-exchange.com/api/v2/account/verify/\", {\n        name\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + session.token\n        }\n      }).then(data => {\n        toast.success(data.data.message, toastOpt);\n      }).catch(err => {\n        console.log(err);\n        toast.error(\"با خطا مواجه شد.\");\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const userUpdateImage = (image, toast, toastOpt) => {\n  return dispatch => {\n    sessionService.loadSession().then(session => {\n      axios.post(\"https://hi-exchange.com/api/v2/account/verify/\", {\n        image\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + session.token\n        }\n      }).then(data => {\n        toast.success(data.data.message, toastOpt);\n      }).catch(err => {\n        console.log(err);\n        toast.error(\"با خطا مواجه شد.\");\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const userUpdatePersonal = info => {\n  return dispatch => {\n    sessionService.loadSession().then(session => {\n      axios.post(BASE + \"/api/v2/account/manage/\", {\n        action: \"profile\",\n        ...info\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + session.token\n        }\n      }).then(response => {\n        const {\n          data\n        } = response;\n\n        if (data.error === 1) {\n          toast.warning(data.message, toastOpt);\n        } else {\n          toast.success(data.message, toastOpt);\n        }\n      }).catch(error => {\n        toast.error(\"با خطا مواجه شد.\", toastOpt);\n        console.log(error);\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const udpate_user_detail = user => {\n  return {\n    type: UPDATE_USER_DETAIL,\n    payload: user\n  };\n};\nexport const udpate_user_profile = profile => {\n  return {\n    type: UPDATE_USER_PROFILE,\n    payload: profile\n  };\n};\nexport const udpate_user_wallet = wallet => {\n  return {\n    type: UPDATE_USER_WALLET,\n    payload: wallet\n  };\n};\nexport const update_auth_id = authID => {\n  return {\n    type: UPDATE_AUTH_ID,\n    payload: authID\n  };\n};\nexport const update_log_status = status => {\n  return {\n    type: UPDATE_LOG_STATUS,\n    payload: status\n  };\n};\nexport const update_log_info = (access, refresh) => {\n  return {\n    type: UPDATE_LOG_INFO,\n    payload: {\n      access,\n      refresh\n    }\n  };\n};\nexport const user_login = (access, refresh) => {\n  return dispatch => {\n    localStorage.setItem(\"hiexchange_token\", access);\n    localStorage.setItem(\"hiexchange_refresh\", refresh);\n    localStorage.setItem(\"hiexchange_refresh_time\", new Date().getTime());\n    dispatch(update_log_status(true));\n    dispatch(update_log_info(access, refresh));\n    dispatch(fetch_user_detail(access)); // dispatch(fetch_user_profile(token));\n  };\n};\nexport const fetch_user_detail = token => {\n  return dispatch => {\n    axios.get(\"https://hi-exchange.com/api/v2/account/details/\", {\n      headers: {\n        \"Authorization\": \"Bearer \" + token\n      }\n    }).then(data => {\n      dispatch(udpate_user_detail(data.data));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const fetch_user_profile = token => {\n  return dispatch => {\n    axios.post(\"https://hi-exchange.com/api/v2/account/manage/\", {\n      headers: {\n        \"Authorization\": \"Bearer \" + token\n      }\n    }).then(data => {\n      dispatch(udpate_user_profile(data.data));\n    }).catch(error => {\n      console.log(error.response.status);\n    });\n  };\n};\nexport const logout = e => {\n  return {\n    type: USER_LOGOUT\n  };\n};","map":{"version":3,"sources":["H:/Projects/package/cheerio/src/redux/actions/user.js"],"names":["UPDATE_USER_DETAIL","UPDATE_USER_PROFILE","UPDATE_AUTH_ID","UPDATE_LOG_STATUS","UPDATE_LOG_INFO","UPDATE_USER_WALLET","USER_LOGOUT","sessionService","axios","toast","toggle_loader_on","toggle_loader_off","toastOpt","position","hideProgressBar","closeOnClick","draggable","autoClose","BASE","userLogout","_history","dispatch","deleteUser","then","e","deleteSession","push","catch","err","console","log","finally","setTimeout","userUpdateDetail","undefined","get","data","saveUser","pathname","userLogin","credentias","setIsSubmitting","post","response","access","token","refresh","saveSession","refresh_time","Date","getTime","error","userSignup","message","success","onClose","userUpdateName","name","loadSession","session","headers","Authorization","userUpdateImage","image","userUpdatePersonal","info","action","warning","udpate_user_detail","user","type","payload","udpate_user_profile","profile","udpate_user_wallet","wallet","update_auth_id","authID","update_log_status","status","update_log_info","user_login","localStorage","setItem","fetch_user_detail","fetch_user_profile","logout"],"mappings":"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","sourcesContent":["import {\r\n    UPDATE_USER_DETAIL,\r\n    UPDATE_USER_PROFILE,\r\n    UPDATE_AUTH_ID,\r\n    UPDATE_LOG_STATUS,\r\n    UPDATE_LOG_INFO,\r\n    UPDATE_USER_WALLET,\r\n    USER_LOGOUT,\r\n} from '../actionTypes'\r\nimport { sessionService } from 'redux-react-session'\r\nimport axios from 'axios';\r\nimport {toast } from 'react-toastify'\r\nimport { toggle_loader_on, toggle_loader_off } from '../actions'\r\n\r\nconst toastOpt = {\r\n    position: \"bottom-left\",\r\n    hideProgressBar: false,\r\n    closeOnClick: true,\r\n    draggable: true,\r\n    autoClose: 5000,\r\n}\r\n\r\n\r\nconst BASE = \"https://hi-exchange.com\"\r\n\r\n\r\nexport const userLogout = (_history)=>{\r\n    return (dispatch)=>{\r\n        dispatch(toggle_loader_on())\r\n        sessionService.deleteUser().then(e=>{\r\n            sessionService.deleteSession().then(e=>{\r\n                _history.push(\"/otp-1\")\r\n            }).catch(err=>{\r\n                console.log(err);\r\n            });\r\n        }).catch(err=>{\r\n            console.log(err)\r\n        }).finally(e=>{\r\n            setTimeout(() => {\r\n                dispatch(toggle_loader_off());\r\n            }, 2000);\r\n        });\r\n    }\r\n}\r\nexport const userUpdateDetail = ( _history=undefined)=>{\r\n    return dispatch=>{\r\n        if(_history)\r\n        dispatch(toggle_loader_on())\r\n        axios.get(BASE + \"/api/v2/account/details/\")\r\n        .then(data=>{\r\n            sessionService.saveUser({ ...data.data }).then(e=>{\r\n                if(_history)\r\n                    _history.push({pathname: \"/\"});\r\n            }).catch(err=>{console.log(err);\r\n            })\r\n        }).catch(err=>{\r\n                console.log(err);\r\n        }).finally(e=>{\r\n            setTimeout(() => {\r\n                if(_history)\r\n                dispatch(toggle_loader_off())\r\n            }, 800);\r\n        })\r\n    }\r\n}\r\nexport const userLogin = (credentias, _history ,setIsSubmitting)=>{\r\n    return dispatch=>{\r\n        axios.post(BASE+\"/api/v2/token/verify/\", credentias)\r\n            .then(response=>{\r\n                dispatch(toggle_loader_on())\r\n                const {data} = response\r\n                const {access:token, refresh} = data;\r\n                sessionService\r\n                .saveSession({ token, refresh, refresh_time: new Date().getTime() }).then(e=>{\r\n                    dispatch(userUpdateDetail(token, _history))\r\n                }).catch(err=>{\r\n                    console.log(err);\r\n                })\r\n            }).catch(err=>{\r\n                toast.error(\"کد وارد شده صحیح نمی باشد.\", toastOpt)\r\n            }).finally(e=>{\r\n                setIsSubmitting(false);\r\n                setTimeout(() => {\r\n                    dispatch(toggle_loader_off())\r\n                }, 800);\r\n            })\r\n    }\r\n}\r\nexport const userSignup = (credentias, _history ,setIsSubmitting)=>{\r\n    return dispatch=>{\r\n        axios.post(BASE+\"/api/v2/token/register/verify/\", credentias)\r\n            .then(response=>{\r\n                if(response.data.error == 1){\r\n                    toast.error(response.data.message, toastOpt)\r\n                }else{\r\n                    toast.success(response.data.message + \" در حال انتقال به صفحه ورود...\", {\r\n                        ...toastOpt,\r\n                        onClose: ()=>{\r\n                            _history.push(\"/signin\")\r\n                        },\r\n                    })\r\n                    _history.push('/sigin')\r\n                }\r\n            }).catch(err=>{\r\n                toast.error(\"کد وارد شده صحیح نمی باشد.\", toastOpt)\r\n            }).finally(e=>{\r\n                setIsSubmitting(false);\r\n                setTimeout(() => {\r\n                    dispatch(toggle_loader_off())\r\n                }, 800);\r\n            })\r\n    }\r\n}\r\nexport const userUpdateName =  (name)=>{\r\n    return dispatch=>{\r\n        sessionService.loadSession().then(session=>{\r\n            axios.post(\"https://hi-exchange.com/api/v2/account/verify/\", {\r\n                name\r\n            },\r\n            {headers:{\r\n                Authorization: \"Bearer \" + session.token\r\n            }}\r\n            ).then(data=>{\r\n                toast.success(data.data.message, toastOpt);  \r\n            }).catch(err=>{\r\n                console.log(err);\r\n                toast.error(\"با خطا مواجه شد.\")\r\n            })\r\n        }).catch(err=>{console.log(err);\r\n        })\r\n    }\r\n}\r\nexport const userUpdateImage =  (image, toast, toastOpt)=>{\r\n    return dispatch=>{\r\n        sessionService.loadSession().then(session=>{\r\n            axios.post(\"https://hi-exchange.com/api/v2/account/verify/\", {\r\n                image\r\n            },\r\n            {headers:{\r\n                Authorization: \"Bearer \" + session.token\r\n            }}\r\n            ).then(data=>{\r\n                toast.success(data.data.message, toastOpt);  \r\n            }).catch(err=>{\r\n                console.log(err);\r\n                toast.error(\"با خطا مواجه شد.\")\r\n            })\r\n        }).catch(err=>{console.log(err);\r\n        })\r\n    }\r\n}\r\nexport const userUpdatePersonal = (info)=>{\r\n    return dispatch=>{\r\n        \r\n        sessionService.loadSession().then(session=>{\r\n            axios.post(BASE+\"/api/v2/account/manage/\", {\r\n                action: \"profile\",\r\n                ...info\r\n            },{\r\n                headers:{\r\n                    Authorization: \"Bearer \" + session.token\r\n                }\r\n            }).then(response=>{\r\n                const {data} = response;\r\n                if (data.error === 1){\r\n                    toast.warning(data.message, toastOpt);\r\n                }else{\r\n                    toast.success(data.message, toastOpt)\r\n                }\r\n            }).catch(error=>{\r\n                toast.error(\"با خطا مواجه شد.\", toastOpt)\r\n                console.log(error)\r\n            })\r\n        }).catch(err=>{console.log(err);\r\n        })\r\n    }\r\n}\r\n\r\nexport const udpate_user_detail = (user)=>{\r\n    return {\r\n        type: UPDATE_USER_DETAIL,\r\n        payload: user\r\n    }\r\n}\r\nexport const udpate_user_profile = (profile)=>{\r\n    return {\r\n        type: UPDATE_USER_PROFILE,\r\n        payload: profile\r\n    }\r\n}\r\n\r\nexport const udpate_user_wallet = (wallet)=>{\r\n    return {\r\n        type: UPDATE_USER_WALLET,\r\n        payload: wallet\r\n    }\r\n}\r\nexport const update_auth_id = (authID)=>{\r\n    return {\r\n        type: UPDATE_AUTH_ID,\r\n        payload: authID\r\n    }\r\n}\r\nexport const update_log_status = (status)=>{\r\n    return {\r\n        type: UPDATE_LOG_STATUS,\r\n        payload: status\r\n    }\r\n}\r\nexport const update_log_info = (access, refresh)=>{\r\n    return {\r\n        type: UPDATE_LOG_INFO,\r\n        payload: {access, refresh}\r\n    }\r\n}\r\nexport const user_login = (access, refresh)=>{\r\n    return dispatch=>{\r\n        localStorage.setItem(\"hiexchange_token\", access);\r\n        localStorage.setItem(\"hiexchange_refresh\", refresh);\r\n        localStorage.setItem(\"hiexchange_refresh_time\", new Date().getTime());\r\n        dispatch(update_log_status(true))\r\n        dispatch(update_log_info(access, refresh));\r\n        dispatch(fetch_user_detail(access));\r\n            // dispatch(fetch_user_profile(token));\r\n    }\r\n}\r\nexport const fetch_user_detail = (token)=>{\r\n    return (dispatch) => {\r\n        axios.get(\"https://hi-exchange.com/api/v2/account/details/\", {\r\n            headers: {\r\n                \"Authorization\": \"Bearer \"+token,\r\n            }\r\n        }).then(data=>{\r\n            dispatch(udpate_user_detail(data.data))\r\n        }).catch(err=>{\r\n            console.log(err);\r\n        })\r\n    }\r\n}\r\nexport const fetch_user_profile = (token)=>{\r\n    return (dispatch) => {\r\n        axios.post(\"https://hi-exchange.com/api/v2/account/manage/\", {\r\n            headers: {\r\n                \"Authorization\": \"Bearer \"+token\r\n            }\r\n        }).then(data=>{\r\n            dispatch(udpate_user_profile(data.data))\r\n        }).catch(error=>{\r\n            console.log(error.response.status);\r\n        })\r\n    }\r\n}\r\nexport const logout = e=>{\r\n    return {\r\n        type: USER_LOGOUT\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}