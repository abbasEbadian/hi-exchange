{"ast":null,"code":"import axios from 'axios';\nimport { resolve } from './resolve.js';\nimport React from 'react';\n\nconst get_token = async () => {\n  const token = localStorage.getItem(\"hiexchange_token\");\n  const refresh_time = +localStorage.getItem(\"hiexchange_refresh_time\");\n  const refresh = localStorage.getItem(\"hiexchange_refresh\");\n\n  if (token && refresh_time && refresh) {\n    const now = new Date();\n\n    if (now.getTime() - refresh_time > 60 * 30 * 1000) {\n      axios.post(\"https://hi-exchange.com/api/v2/token/refresh/\", {\n        refresh\n      }).then(data => {\n        localStorage.setItem(\"hiexchange_token\", data.data.access);\n        localStorage.setItem(\"hiexchange_refresh_time\", new Date().now());\n        return data.data.access;\n      });\n    } else {\n      return token;\n    }\n  } else {\n    return undefined;\n  }\n};\n\nexport async function fetchApi(method, url, data) {\n  const base_url = \"https://hi-exchange.com/\";\n  await get_token().then(token => {\n    if (token) {\n      return axios({\n        method,\n        url: base_url + url,\n        data,\n        headers: {\n          \"Authorization\": \"Bearer \" + token\n        }\n      });\n    }\n  });\n}\nexport async function fetchApiAnonym(method, url, data) {\n  const base_url = \"https://hi-exchange.com/\";\n  return axios({\n    method,\n    url: base_url + url,\n    data\n  });\n}","map":{"version":3,"sources":["H:/Projects/package/cheerio/src/api/api.js"],"names":["axios","resolve","React","get_token","token","localStorage","getItem","refresh_time","refresh","now","Date","getTime","post","then","data","setItem","access","undefined","fetchApi","method","url","base_url","headers","fetchApiAnonym"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,cAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,MAAMC,SAAS,GAAE,YAAU;AACzB,QAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,kBAArB,CAAd;AACA,QAAMC,YAAY,GAAG,CAACF,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAtB;AACA,QAAME,OAAO,GAAGH,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAAhB;;AACA,MAAGF,KAAK,IAAIG,YAAT,IAAyBC,OAA5B,EAAoC;AAClC,UAAMC,GAAG,GAAG,IAAIC,IAAJ,EAAZ;;AACA,QAAID,GAAG,CAACE,OAAJ,KAAgBJ,YAAhB,GAA+B,KAAG,EAAH,GAAM,IAAzC,EAA8C;AAC1CP,MAAAA,KAAK,CAACY,IAAN,CAAW,+CAAX,EAA2D;AAACJ,QAAAA;AAAD,OAA3D,EACCK,IADD,CACMC,IAAI,IAAE;AACVT,QAAAA,YAAY,CAACU,OAAb,CAAqB,kBAArB,EAAyCD,IAAI,CAACA,IAAL,CAAUE,MAAnD;AACAX,QAAAA,YAAY,CAACU,OAAb,CAAqB,yBAArB,EAAgD,IAAIL,IAAJ,GAAWD,GAAX,EAAhD;AACA,eAAOK,IAAI,CAACA,IAAL,CAAUE,MAAjB;AACD,OALD;AAMH,KAPD,MAOK;AACD,aAAOZ,KAAP;AACH;AACF,GAZD,MAYK;AACD,WAAOa,SAAP;AACH;AACF,CAnBD;;AAoBA,OAAO,eAAeC,QAAf,CAAwBC,MAAxB,EAAgCC,GAAhC,EAAqCN,IAArC,EAA0C;AAC/C,QAAMO,QAAQ,GAAG,0BAAjB;AACA,QAAMlB,SAAS,GAAGU,IAAZ,CAAiBT,KAAK,IAAE;AAC5B,QAAGA,KAAH,EAAS;AACP,aAAQJ,KAAK,CAAC;AACZmB,QAAAA,MADY;AAEZC,QAAAA,GAAG,EAAEC,QAAQ,GAACD,GAFF;AAGZN,QAAAA,IAHY;AAIZQ,QAAAA,OAAO,EAAC;AACJ,2BAAiB,YAAWlB;AADxB;AAJI,OAAD,CAAb;AAQD;AACF,GAXK,CAAN;AAaD;AACD,OAAO,eAAemB,cAAf,CAA8BJ,MAA9B,EAAsCC,GAAtC,EAA2CN,IAA3C,EAAiD;AACtD,QAAMO,QAAQ,GAAG,0BAAjB;AACA,SAAQrB,KAAK,CAAC;AACZmB,IAAAA,MADY;AAEZC,IAAAA,GAAG,EAAEC,QAAQ,GAACD,GAFF;AAGZN,IAAAA;AAHY,GAAD,CAAb;AAMD","sourcesContent":["import axios from 'axios';\r\nimport { resolve } from './resolve.js';\r\nimport React from 'react'\r\n\r\nconst get_token= async ()=>{\r\n  const token = localStorage.getItem(\"hiexchange_token\");\r\n  const refresh_time = +localStorage.getItem(\"hiexchange_refresh_time\");\r\n  const refresh = localStorage.getItem(\"hiexchange_refresh\");\r\n  if(token && refresh_time && refresh){\r\n    const now = new Date()\r\n    if (now.getTime() - refresh_time > 60*30*1000){\r\n        axios.post(\"https://hi-exchange.com/api/v2/token/refresh/\",{refresh})\r\n        .then(data=>{\r\n          localStorage.setItem(\"hiexchange_token\", data.data.access);\r\n          localStorage.setItem(\"hiexchange_refresh_time\", new Date().now());\r\n          return data.data.access\r\n        })\r\n    }else{\r\n        return token\r\n    }\r\n  }else{\r\n      return undefined\r\n  }\r\n}\r\nexport async function fetchApi(method, url, data){\r\n  const base_url = \"https://hi-exchange.com/\"\r\n  await get_token().then(token=>{\r\n    if(token){\r\n      return  axios({\r\n        method,\r\n        url: base_url+url,\r\n        data,\r\n        headers:{\r\n            \"Authorization\": \"Bearer \"+ token\r\n        }\r\n      })\r\n    }\r\n  })\r\n \r\n}\r\nexport async function fetchApiAnonym(method, url, data,){\r\n  const base_url = \"https://hi-exchange.com/\"\r\n  return  axios({\r\n    method,\r\n    url: base_url+url,\r\n    data,\r\n  })\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}