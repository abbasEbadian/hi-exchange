{"ast":null,"code":"import axios from 'axios';\nimport { resolve } from './resolve.js';\nimport React from 'react';\n\nconst get_token = () => {\n  const token = localStorage.getItem(\"hiexchange_token\");\n  const refresh_time = +localStorage.getItem(\"hiexchange_refresh_time\");\n  const refresh = localStorage.getItem(\"hiexchange_refresh\");\n\n  if (token && refresh_time && refresh) {\n    const now = new Date();\n\n    if (now.getTime() - refresh_time > 60 * 30 * 1000) {\n      fetchApi(\"post\", \"/api/v2/token/refresh/\", {\n        refresh\n      }, true).then(data => {\n        localStorage.setItem(\"hiexchange_token\", data.data.access);\n        localStorage.setItem(\"hiexchange_refresh_time\", new Date().now());\n      });\n    } else {\n      if (!isLogged) dispatch(user_login(token, refresh));\n    }\n  } else {\n    console.log(\"CAME\");\n    dispatch(logout());\n  }\n};\n\nexport async function fetchApi(method, url, data, is_refresh = false) {\n  if (!is_refresh) {\n    const token = get_token();\n    if (!get_token) return;\n  }\n\n  const base_url = \"https://hi-exchange.com/\";\n  return await axios({\n    method,\n    url: base_url + url,\n    data\n  });\n}","map":{"version":3,"sources":["H:/Projects/package/cheerio/src/api/api.js"],"names":["axios","resolve","React","get_token","token","localStorage","getItem","refresh_time","refresh","now","Date","getTime","fetchApi","then","data","setItem","access","isLogged","dispatch","user_login","console","log","logout","method","url","is_refresh","base_url"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,cAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,MAAMC,SAAS,GAAE,MAAI;AACnB,QAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,kBAArB,CAAd;AACA,QAAMC,YAAY,GAAG,CAACF,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAtB;AACA,QAAME,OAAO,GAAGH,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAAhB;;AACA,MAAGF,KAAK,IAAIG,YAAT,IAAyBC,OAA5B,EAAoC;AAClC,UAAMC,GAAG,GAAG,IAAIC,IAAJ,EAAZ;;AACA,QAAID,GAAG,CAACE,OAAJ,KAAgBJ,YAAhB,GAA+B,KAAG,EAAH,GAAM,IAAzC,EAA8C;AAC1CK,MAAAA,QAAQ,CAAC,MAAD,EAAS,wBAAT,EAAkC;AAACJ,QAAAA;AAAD,OAAlC,EAA6C,IAA7C,CAAR,CACCK,IADD,CACMC,IAAI,IAAE;AACVT,QAAAA,YAAY,CAACU,OAAb,CAAqB,kBAArB,EAAyCD,IAAI,CAACA,IAAL,CAAUE,MAAnD;AACAX,QAAAA,YAAY,CAACU,OAAb,CAAqB,yBAArB,EAAgD,IAAIL,IAAJ,GAAWD,GAAX,EAAhD;AACD,OAJD;AAKH,KAND,MAMK;AACD,UAAI,CAACQ,QAAL,EACAC,QAAQ,CAACC,UAAU,CAACf,KAAD,EAAQI,OAAR,CAAX,CAAR;AACH;AACF,GAZD,MAYK;AACDY,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACAH,IAAAA,QAAQ,CAACI,MAAM,EAAP,CAAR;AACH;AACF,CApBD;;AAqBA,OAAO,eAAeV,QAAf,CAAwBW,MAAxB,EAAgCC,GAAhC,EAAqCV,IAArC,EAA2CW,UAAU,GAAC,KAAtD,EAA4D;AACjE,MAAI,CAACA,UAAL,EAAgB;AACd,UAAMrB,KAAK,GAAGD,SAAS,EAAvB;AACA,QAAG,CAACA,SAAJ,EAAc;AAEf;;AACD,QAAMuB,QAAQ,GAAG,0BAAjB;AACA,SAAO,MAAM1B,KAAK,CAAC;AACjBuB,IAAAA,MADiB;AAEjBC,IAAAA,GAAG,EAAEE,QAAQ,GAACF,GAFG;AAGjBV,IAAAA;AAHiB,GAAD,CAAlB;AAKD","sourcesContent":["import axios from 'axios';\r\nimport { resolve } from './resolve.js';\r\nimport React from 'react'\r\n\r\nconst get_token= ()=>{\r\n  const token = localStorage.getItem(\"hiexchange_token\");\r\n  const refresh_time = +localStorage.getItem(\"hiexchange_refresh_time\");\r\n  const refresh = localStorage.getItem(\"hiexchange_refresh\");\r\n  if(token && refresh_time && refresh){\r\n    const now = new Date()\r\n    if (now.getTime() - refresh_time > 60*30*1000){\r\n        fetchApi(\"post\", \"/api/v2/token/refresh/\",{refresh}, true )\r\n        .then(data=>{\r\n          localStorage.setItem(\"hiexchange_token\", data.data.access);\r\n          localStorage.setItem(\"hiexchange_refresh_time\", new Date().now());\r\n        })\r\n    }else{\r\n        if (!isLogged)\r\n        dispatch(user_login(token, refresh));\r\n    }\r\n  }else{\r\n      console.log(\"CAME\")\r\n      dispatch(logout())\r\n  }\r\n}\r\nexport async function fetchApi(method, url, data, is_refresh=false){\r\n  if (!is_refresh){\r\n    const token = get_token()\r\n    if(!get_token)return\r\n\r\n  }\r\n  const base_url = \"https://hi-exchange.com/\"\r\n  return await axios({\r\n    method,\r\n    url: base_url+url,\r\n    data\r\n  })\r\n}"]},"metadata":{},"sourceType":"module"}